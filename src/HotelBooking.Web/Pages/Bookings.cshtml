@page
@model HotelBooking.Web.Pages.BookingsModel
@using HotelBooking.Domain.Enums
@{
    ViewData["Title"] = "Мої бронювання";
    
    string GetStatusColor(BookingStatus status) => status switch
    {
        BookingStatus.Pending => "bg-yellow-100 text-yellow-800",
        BookingStatus.Confirmed => "bg-green-100 text-green-800",
        BookingStatus.CheckedIn => "bg-blue-100 text-blue-800",
        BookingStatus.CheckedOut => "bg-gray-100 text-gray-800",
        BookingStatus.Cancelled => "bg-red-100 text-red-800",
        _ => "bg-gray-100 text-gray-800"
    };
    
    string GetStatusText(BookingStatus status) => status switch
    {
        BookingStatus.Pending => "Очікує",
        BookingStatus.Confirmed => "Підтверджено",
        BookingStatus.CheckedIn => "Заселено",
        BookingStatus.CheckedOut => "Виселено",
        BookingStatus.Cancelled => "Скасовано",
        _ => status.ToString()
    };
}

<div class="max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">📋 Мої бронювання</h1>

    @if (!Model.Bookings.Any())
    {
        <div class="bg-white rounded-xl shadow-lg p-8 text-center">
            <div class="text-6xl mb-4">🏨</div>
            <h2 class="text-xl font-semibold text-gray-700 mb-2">У вас ще немає бронювань</h2>
            <p class="text-gray-500 mb-4">Знайдіть ідеальний готель і забронюйте номер!</p>
            <a href="/" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                Переглянути готелі
            </a>
        </div>
    }
    else
    {
        <div class="space-y-4">
            @foreach (var booking in Model.Bookings)
            {
                <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition duration-300">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <h3 class="text-xl font-bold text-gray-800">@booking.HotelName</h3>
                                <span class="px-3 py-1 rounded-full text-sm font-medium @GetStatusColor(booking.Status)">@GetStatusText(booking.Status)</span>
                            </div>
                            <p class="text-gray-600 mb-1">🚪 Номер: <span class="font-medium">@booking.RoomNumber</span></p>
                            <p class="text-gray-600 mb-1">📅 @booking.CheckInDate.ToString("dd.MM.yyyy") — @booking.CheckOutDate.ToString("dd.MM.yyyy")</p>
                            <p class="text-gray-600">👥 Гостей: @booking.NumberOfGuests</p>
                            @if (!string.IsNullOrEmpty(booking.SpecialRequests))
                            {
                                <p class="text-gray-500 text-sm mt-2">📝 @booking.SpecialRequests</p>
                            }
                        </div>
                        <div class="mt-4 md:mt-0 md:text-right">
                            <p class="text-2xl font-bold text-green-600">@booking.TotalPrice.ToString("N0") ₴</p>
                            <p class="text-sm text-gray-500">Бронювання #@booking.Id</p>
                            @if (booking.Status == BookingStatus.Pending || booking.Status == BookingStatus.Confirmed)
                            {
                                <form method="post" asp-page-handler="Cancel" class="mt-2">
                                    <input type="hidden" name="bookingId" value="@booking.Id" />
                                    <button type="submit" 
                                            onclick="return confirm('Ви впевнені, що хочете скасувати бронювання?')"
                                            class="text-red-600 hover:text-red-800 text-sm font-medium">
                                        ❌ Скасувати
                                    </button>
                                </form>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>
